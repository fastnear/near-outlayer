# Keystore Worker Configuration

# ============= Server Configuration =============
# Server binding address
SERVER_HOST=0.0.0.0
SERVER_PORT=8081

# Security
# SHA256 hash of bearer tokens that executor workers must provide
# Example: echo -n "my-secure-token-123" | shasum -a 256
ALLOWED_WORKER_TOKEN_HASHES=cbd8f6f0e3e8ec29d3d1f58a2c8c6d6e8d7f5a4b3c2d1e0f1a2b3c4d5e6f7a8b

# ============= TEE Configuration =============
# TEE mode: none, sgx, tdx, sev
TEE_MODE=none

# Enable TEE registration and MPC CKD
USE_TEE_REGISTRATION=false

# ============= Development Mode (non-TEE) =============
# Master secret for keystore (64 hex characters)
# Generate: openssl rand -hex 32
# Will be generated automatically if not provided
# In TEE mode, this is derived from MPC CKD instead
KEYSTORE_MASTER_SECRET=

# ============= NEAR Configuration =============
# NEAR RPC endpoint
NEAR_RPC_URL=https://rpc.testnet.near.org

# OutLayer contract for reading secrets (REQUIRED for repo-based secrets)
NEAR_CONTRACT_ID=outlayer.testnet

# ============= DAO Registration (TEE mode) =============
# Keymaster DAO contract
KEYSTORE_DAO_CONTRACT=keystore-dao.outlayer.testnet

# Init account for paying gas during registration
INIT_ACCOUNT_ID=init-keymaster.outlayer.testnet
INIT_ACCOUNT_PRIVATE_KEY=ed25519:...

# ============= MPC CKD Configuration (TEE mode) =============
# MPC contract for Chain Key Derivation
MPC_CONTRACT_ID=v1.signer.testnet

# MPC domain ID for BLS12-381 (usually 2)
MPC_DOMAIN_ID=2

# MPC public key for the domain (BLS12-381 G2 format)
# Example: bls12381g2:22AgdyBXAQor5kiToW4frjEksuAhyic1S7CWWX7LFBTXFt1MxjcXwuB73yFCQVQfwMjKQoFFtmxPSUg2fCjhNUNVCFPVdtotAFMkPpoDg9s3QWQSZ2gUfvS3Uw1gaESFCfrw
MPC_PUBLIC_KEY=

# ============= Phala TEE Configuration =============
# Phala dstack socket (for TDX attestation)
DSTACK_SIMULATOR_ENDPOINT=/var/run/dstack.sock

# ============= Logging =============
# Log level: trace, debug, info, warn, error
RUST_LOG=info,keystore_worker=debug

# ============= Example Configurations =============

# === Development (no TEE) ===
# TEE_MODE=none
# USE_TEE_REGISTRATION=false
# KEYSTORE_MASTER_SECRET=0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef

# === Testnet with TEE ===
# TEE_MODE=tdx
# USE_TEE_REGISTRATION=true
# KEYSTORE_DAO_CONTRACT=keystore-dao.outlayer.testnet
# INIT_ACCOUNT_ID=init-keymaster.outlayer.testnet
# INIT_ACCOUNT_PRIVATE_KEY=ed25519:4Msz2nGwYFtUGUKM2tGKPMzxBu5zs7zBpHUcms3P9d4qCtDPJiAiXNMPsunMar5tkkFmmk3j2dY656U95tU67YZF
# MPC_CONTRACT_ID=v1.signer.testnet
# MPC_DOMAIN_ID=2
# MPC_PUBLIC_KEY=bls12381g2:...

# === Mainnet with TEE ===
# TEE_MODE=tdx
# USE_TEE_REGISTRATION=true
# NEAR_RPC_URL=https://rpc.mainnet.near.org
# KEYSTORE_DAO_CONTRACT=keystore-dao.outlayer.near
# MPC_CONTRACT_ID=v1.signer
# NEAR_CONTRACT_ID=outlayer.near